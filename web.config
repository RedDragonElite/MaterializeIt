<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
	
	<!-- ###################################
	     #      .::MaterializeIt::.        #
	     #   Website Systems Web.Config    #		 
		 #    https://www.rd-elite.com/    #
		 ################################### -->
		 
		<defaultDocument enabled="true">
		  <files>
			<clear />
			<add value="index.php" />
			<add value="index.html" />
			<add value="default.html" />
		  </files>
		</defaultDocument>
		<security>
		  <authentication>
			<basicAuthentication enabled="true" />
		  </authentication>
		</security>
		<httpErrors errorMode="Custom">
		  <remove statusCode="404" subStatusCode="-1" />
		  <error statusCode="404" prefixLanguageFilePath="" path="/System/Error/Error_404.php" responseMode="ExecuteURL" />
		</httpErrors>
		<!-- HIDE ASP.NET -->
		<httpProtocol>
		  <customHeaders>
			<remove name="X-Powered-By" />
		  </customHeaders>
		</httpProtocol>	
		
	<!-- ###################################
		 #                                 #
		 #            Security             #		 
		 #                                 #
		 ################################### -->
		 
        <security>
            <requestFiltering>
                <fileExtensions applyToWebDAV="false">
                     <add fileExtension=".csv" allowed="false" />
					 <add fileExtension=".cfg" allowed="false" />
					 <add fileExtension=".dev" allowed="false" />							 
                </fileExtensions>
            </requestFiltering>
		  <authorization>
			<!-- Deny all users access to the root of the website, since it
				 contains this web.config -->
				<remove users="*" roles="" verbs="" />
			<add accessType="Deny" users="*" />
		  </authorization>			
        </security>		
		
		<!-- REWRITE SECTION -->	
		<rewrite>
		  
		  <rules>
                <rule name="CanonicalHostNameRule1" stopProcessing="true">
                    <match url="185.194.141.10" />
                    <conditions>
                        <add input="{HTTP_HOST}" pattern="185.194.141.10" />
                    </conditions>
                    <action type="Redirect" url="layout.materializedcms.com" />
                </rule>
		  
			<!-- ###################################
				 #                                 #
				 #          Other Stuff            #		 
				 #                                 #
				 ################################### -->
			
				<!-- Rewrite Robot.txt to Robot.php to add php code inside -->
                <rule name="Rewrite Tool - robots.txt to robots.php" stopProcessing="true">
                    <match url="^robots\.txt$" />
                    <conditions logicalGrouping="MatchAll">
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
                    </conditions>
                    <action type="Rewrite" url="robots.php" />
                </rule>
				
				<!-- Redirect HTTP to HTTPS -->	
				<rule name="HTTPS force" enabled="true" stopProcessing="true">
					<match url="(.*)" />
					<conditions>
					<add input="{HTTPS}" pattern="^OFF$" />
					</conditions>
					<action type="Redirect" url="https://{HTTP_HOST}{REQUEST_URI}" redirectType="Permanent" />
				</rule>					

				<!-- Redirect Server IP to Domain Name Canonical FIX -->
                <rule name="IP to Domain Redirect Hit" stopProcessing="true">
                    <match url="(.*)" />
                    <conditions>
                        <add input="{HTTP_HOST}" pattern="185.194.141.10" />
                    </conditions>
                    <action type="Redirect" url="https://{HTTP_HOST}{REQUEST_URI}" redirectType="Permanent" />
                </rule>		
			 
		  </rules>
		</rewrite>
    </system.webServer>
</configuration>
